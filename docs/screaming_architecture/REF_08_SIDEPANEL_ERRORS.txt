> Status: Archived (Log)
> Owner: Gerson Santiago
> Context: Reference for "Why moving sidepanel breaks everything"

# ðŸ›‘ Root Cause Analysis: The "Sidepanel" Dependency Hell

Por que renomear `sidepanel` quebra o projeto inteirinho?

1.  **Jest Aliases (`jest.config.js`)**:
    *   O Jest estÃ¡ configurado para olhar `@sidepanel` -> `<rootDir>/sidepanel`.
    *   Ao renomear a pasta, o alias aponta para o vazio. Todos os testes que usam `@sidepanel` falham imediatamente.

2.  **Imports Relativos Hardcoded**:
    *   Muitos arquivos (especialmente testes antigos) fazem `import ... from '../../sidepanel/...'`.
    *   O Node.js nÃ£o consegue resolver esses caminhos fÃ­sicos quando a pasta muda de nome.

3.  **Entry Points (Manifest)**:
    *   O `manifest.json` aponta para `sidepanel/sidepanel.html`. Se a pasta some, a extensÃ£o nÃ£o carrega.

---

# ðŸ“œ Log Original de Erros (Raw Output)
sant@penguin:~/extensaoUNIVESP (refactor/sidepanel_old)$ npm test

> univesp-extension@2.6.1 test
> jest

 FAIL  tests/imports.test.js (5.625 s)
  VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/jest.setup.js (9 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/sidepanel.js (7 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/utils/statusManager.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/components/Shared/ActionMenu.js (3 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/components/Modals/Modal.js (9 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/components/Modals/LoginWaitModal.js (4 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/components/Layout/TopNav.js (7 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/components/Layout/MainLayout.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/sidepanel_old/components/Forms/ConfigForm.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/shared/utils/settings.js (92 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/shared/utils/Tabs.js (13 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/shared/utils/BrowserUtils.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/shared/logic/AutoScroll.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/scripts/content.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/scripts/background.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/popup/popup.js
    âœ• Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/settings/ui/SettingsView.js (5 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/settings/logic/raManager.js
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/settings/logic/domainManager.js
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/tests/BatchScraper_DOM.test.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/tests/BatchScraper.test.js (2 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/tests/BatchImportModal.test.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/services/BatchScraper.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/logic/BatchImportFlow.js
    âœ• Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/components/BatchImportModal.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/home/ui/HomeView.js (3 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/feedback/ui/FeedbackView.js
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/tests/TermParser.test.js
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/tests/ScraperService.test.js (2 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/tests/CourseRepository.test.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/tests/CourseGrouper.test.js
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/services/ScraperService.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/logic/TermParser.js
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/logic/CourseService.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/logic/CourseGrouper.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/data/CourseStorage.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/data/CourseRepository.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/WeekItem.js (1 ms)
    âœ• Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/CoursesList.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/CourseItem.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/CourseDetailsView.js (1 ms)
    âœ• Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/AddManualModal.js (1 ms)
    âœ“ Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/docs/investigaÃ§Ã£o/scroll.js (2 ms)
    âœ• Manifest resources devem existir (34 ms)

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/settings/ui/SettingsView.js

    LINK QUEBRADO: 'features/settings/ui/SettingsView.js' tenta importar '../../../sidepanel/utils/statusManager.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/utils/statusManager.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/components/BatchImportModal.js

    LINK QUEBRADO: 'features/import/components/BatchImportModal.js' tenta importar '../../../sidepanel/components/Modals/Modal.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/components/Modals/Modal.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/CoursesList.js

    LINK QUEBRADO: 'features/courses/components/CoursesList.js' tenta importar '../../../sidepanel/components/Shared/ActionMenu.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/components/Shared/ActionMenu.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/AddManualModal.js

    LINK QUEBRADO: 'features/courses/components/AddManualModal.js' tenta importar '../../../sidepanel/components/Modals/Modal.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/components/Modals/Modal.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Manifest resources devem existir

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      73 |     if (manifest.side_panel && manifest.side_panel.default_path) {
      74 |       const spPath = path.join(projectRoot, manifest.side_panel.default_path);
    > 75 |       expect(fs.existsSync(spPath)).toBe(true);
         |                                     ^
      76 |     }
      77 |
      78 |     // Verifica content scripts

      at Object.toBe (tests/imports.test.js:75:37)

 PASS  features/courses/tests/CourseRepository.test.js
  Storage - CRUD de Cursos
    loadItems()
      âœ“ Deve carregar lista vazia por padrÃ£o (16 ms)
      âœ“ Deve carregar cursos existentes (6 ms)
      âœ“ Deve chamar callback com dados corretos (4 ms)
    saveItems()
      âœ“ Deve salvar lista de cursos (4 ms)
      âœ“ Deve executar callback apÃ³s salvar (4 ms)
      âœ“ Deve funcionar sem callback (2 ms)
    addItem()
      âœ“ Deve adicionar curso com sucesso (3 ms)
      âœ“ Deve gerar ID Ãºnico usando Date.now() (2 ms)
      âœ“ Deve rejeitar duplicata (mesma URL) (2 ms)
      âœ“ Deve incluir weeks vazio por padrÃ£o (2 ms)
      âœ“ Deve passar weeks customizado (1 ms)
      âœ“ Deve persistir termName passado via options (7 ms)
    addItemsBatch()
      âœ“ Deve adicionar mÃºltiplos cursos (9 ms)
      âœ“ Deve gerar IDs Ãºnicos para cada curso (1 ms)
      âœ“ Deve ignorar duplicatas (2 ms)
      âœ“ Deve retornar contadores corretos (10 ms)
      âœ“ Deve lidar com lista vazia (2 ms)
      âœ“ Deve nÃ£o salvar se todos sÃ£o duplicatas (7 ms)
      âœ“ Deve persistir termName nos itens do lote (4 ms)
    deleteItem()
      âœ“ Deve remover curso existente (1 ms)
      âœ“ Deve lidar com ID inexistente (2 ms)
      âœ“ Deve executar callback (2 ms)
    updateItem()
      âœ“ Deve atualizar curso existente (1 ms)
      âœ“ Deve mesclar updates com dados existentes (2 ms)
      âœ“ Deve lidar com ID inexistente sem falhar (3 ms)
      âœ“ Deve executar callback mesmo com ID inexistente (2 ms)
    clearItems()
      âœ“ Deve limpar todos os cursos (2 ms)
      âœ“ Deve chamar saveItems com array vazio (2 ms)
      âœ“ Deve executar callback (1 ms)

 PASS  features/import/tests/BatchScraper.test.js
  LÃ³gica - Batch Scraper
    scrapeAvailableTerms
      âœ“ Deve retornar termos agrupados corretamente por Display ID (9 ms)
      âœ“ Deve lidar com falha no script (3 ms)
    processSelectedCourses
      âœ“ Deve processar cursos selecionados (Deep Scraping) (3 ms)
      âœ“ Deve retornar array vazio em caso de erro (3 ms)

 PASS  tests/settings.test.js
  Settings - FormataÃ§Ã£o de Email e DomÃ­nio
    formatEmail()
      âœ“ Deve formatar RA simples com domÃ­nio que jÃ¡ tem @ (4 ms)
      âœ“ Deve adicionar @ ao domÃ­nio se nÃ£o tiver (4 ms)
      âœ“ Deve remover @ do RA se jÃ¡ estiver incluÃ­do (2 ms)
      âœ“ Deve fazer trim em RA com espaÃ§os (1 ms)
      âœ“ Deve fazer trim no domÃ­nio com espaÃ§os (1 ms)
      âœ“ Deve lidar com RA e domÃ­nio ambos precisando de limpeza (1 ms)
    extractRa()
      âœ“ Deve extrair RA de email completo (3 ms)
      âœ“ Deve retornar RA se jÃ¡ estiver sem @ (1 ms)
      âœ“ Deve retornar string vazia para null
      âœ“ Deve retornar string vazia para undefined (5 ms)
      âœ“ Deve retornar string vazia para string vazia (5 ms)
      âœ“ Deve lidar com mÃºltiplos @ no email (1 ms)
    resolveDomain()
      âœ“ Deve priorizar customDomain se fornecido (4 ms)
      âœ“ Deve extrair domÃ­nio de userEmail se nÃ£o hÃ¡ customDomain (4 ms)
      âœ“ Deve retornar DEFAULT_DOMAIN se ambos sÃ£o null (2 ms)
      âœ“ Deve retornar DEFAULT_DOMAIN se userEmail nÃ£o tem @ (1 ms)
      âœ“ Deve retornar DEFAULT_DOMAIN se userEmail Ã© string vazia (1 ms)
      âœ“ Deve lidar com mÃºltiplos @ no userEmail (5 ms)
      âœ“ Deve ignorar userEmail se customDomain estÃ¡ presente (6 ms)
    CONSTANTS
      âœ“ Deve ter DEFAULT_DOMAIN definido corretamente (1 ms)
      âœ“ DEFAULT_DOMAIN deve ser uma string (4 ms)
      âœ“ DEFAULT_DOMAIN deve comeÃ§ar com @ (3 ms)

 PASS  features/courses/tests/ScraperService.test.js
  Testes de LÃ³gica - Scraper
    âœ“ scrapeWeeksFromTab deve chamar executeScript corretamente (11 ms)
    âœ“ scrapeWeeksFromTab deve lidar com retorno vazio (10 ms)
    âœ“ scrapeWeeksFromTab deve mesclar resultados de mÃºltiplos frames (6 ms)
    âœ“ scrapeWeeksFromTab deve remover duplicatas baseado em URL (5 ms)
    âœ“ scrapeWeeksFromTab deve ordenar semanas por nÃºmero (2 ms)
    âœ“ scrapeWeeksFromTab deve ignorar semanas sem URL (2 ms)
    âœ“ scrapeWeeksFromTab deve lidar com erro no executeScript (2 ms)
    âœ“ scrapeWeeksFromTab deve lidar com result undefined (3 ms)
    âœ“ scrapeWeeksFromTab deve lidar com weeks nÃ£o sendo array (2 ms)
    âœ“ scrapeWeeksFromTab deve usar primeiro tÃ­tulo nÃ£o-null encontrado (2 ms)

 PASS  tests/logic/AutoScroll.test.js
  AutoScroll Logic
    âœ“ deve iniciar o scroll e chamar scrollTo (35 ms)
    âœ“ deve parar o scroll quando atingir o final (altura nÃ£o muda) (13 ms)
    âœ“ deve continuar o scroll se a altura aumentar (24 ms)
    âœ“ deve permitir parada manual (22 ms)

 PASS  tests/tabs.test.js
  LÃ³gica - Troca de Abas
    âœ“ Deve alternar para aba correspondente ao course_id exatamente (28 ms)
    âœ“ Deve usar startsWith se course_id nÃ£o for encontrado (9 ms)
    âœ“ Deve criar nova aba se nenhuma correspondÃªncia for encontrada (7 ms)
    âœ“ Deve priorizar content_id exato quando mÃºltiplas abas tiverem o mesmo course_id (8 ms)
    âœ“ Deve lidar com URL sem course_id ou content_id usando startsWith (6 ms)
    âœ“ Deve focar na janela ao alternar abas (12 ms)
    âœ“ Deve criar nova aba quando query retornar array vazio (6 ms)

 PASS  tests/privacy.test.js
  Auditoria de Privacidade e SeguranÃ§a (Deep Scan)
    âœ“ ZERO BACKEND: NÃ£o deve haver chamadas para domÃ­nios externos nÃ£o autorizados (Firebase, Analytics, etc) (7 ms)
    âœ“ SEGURANÃ‡A ARQUITETURAL: PreferÃªncia por chrome.storage sobre localStorage (2 ms)
    âœ“ PRIVACIDADE: NÃ£o deve haver envio de dados via fetch para IPs ou domÃ­nios desconhecidos (6 ms)

 PASS  tests/raManager.test.js
  RaManager
    getRaFromEmail
      âœ“ Should extract RA from email (3 ms)
      âœ“ Should return unchanged if no @ (2 ms)
      âœ“ Should return empty string for null/undefined (5 ms)
    prepareCredentials
      âœ“ Should return valid object for correct input (2 ms)
      âœ“ Should return error if RA is empty (2 ms)
      âœ“ Should clean inputs (1 ms)

 PASS  features/import/tests/BatchScraper_DOM.test.js
  BatchScraper DOM Logic
    âœ“ Deve retornar erro se nÃ£o estiver logado ou na pÃ¡gina errada (60 ms)
    âœ“ Deve tentar realizar auto-scroll (36 ms)
    âœ“ Deve extrair cursos corretamente do DOM (109 ms)

 PASS  features/courses/tests/TermParser.test.js
  termParser Utility
    âœ“ Should parse standard name format "2025/2 - 4Âº Bimestre" (4 ms)
    âœ“ Should parse ID-like format "2026S1B2" inside a string (3 ms)
    âœ“ Should return defaults for unknown format (2 ms)
    âœ“ Should handle object input (1 ms)
    âœ“ Should prioritize termName property if present (6 ms)

 PASS  features/courses/tests/CourseGrouper.test.js
  courseGrouper Utility
    âœ“ Should group courses by term and sort groups descending (5 ms)
    âœ“ Should handle empty list (1 ms)

 PASS  tests/integration/batchImport.integration.test.js
  Integration: Batch Import Flow (Split Architecture)
    âœ“ Should open BatchImportModal directly if AVA course tab is found (9 ms)
    âœ“ Should open LoginWaitModal if AVA tab is found but NOT on course page (2 ms)
    âœ“ Should create new tab and open LoginWaitModal if no AVA tab found (8 ms)

 PASS  tests/storage_persistence.test.js
  Storage Logic - Persistence & v2.4.1 Features
    âœ“ addItemsBatch should persist termName (13 ms)
    âœ“ addItem should accept options object with termName (7 ms)
    âœ“ addItem should work with old signature (backward compatibility) (9 ms)

 PASS  tests/domainManager.test.js
  DomainManager
    getCurrentDomain
      âœ“ Should return custom domain if provided (3 ms)
      âœ“ Should extract domain from email if no custom domain (3 ms)
      âœ“ Should return default domain if nothing provided (1 ms)
    getDefaultDomain
      âœ“ Should return constant default domain (2 ms)

 FAIL  features/import/tests/BatchImportModal.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/import/components/BatchImportModal.js'

    Require stack:
      features/import/components/BatchImportModal.js
      features/import/tests/BatchImportModal.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { scrapeAvailableTerms, processSelectedCourses } from '../services/BatchScraper.js';
      3 | import { CourseRepository } from '../../courses/data/CourseRepository.js';
      4 | import { parseTerm } from '../../courses/logic/TermParser.js';

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/import/components/BatchImportModal.js:1:1)
      at Object.require (features/import/tests/BatchImportModal.test.js:1:1)

 FAIL  tests/integration/scrapeCourse.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/courses/components/AddManualModal.js'

    Require stack:
      features/courses/components/AddManualModal.js
      features/settings/ui/SettingsView.js
      tests/integration/scrapeCourse.integration.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { CourseRepository } from '../data/CourseRepository.js';
      3 |
      4 | export class AddManualModal extends Modal {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/courses/components/AddManualModal.js:1:1)
      at Object.require (features/settings/ui/SettingsView.js:1:1)
      at Object.require (tests/integration/scrapeCourse.integration.test.js:1:1)

 FAIL  tests/integration/navigation.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../sidepanel/components/Layout/MainLayout.js' from 'tests/integration/navigation.integration.test.js'

    > 1 | import { MainLayout } from '../../sidepanel/components/Layout/MainLayout.js';
        | ^
      2 | import { HomeView } from '../../features/home/ui/HomeView.js';
      3 | // We can use mocks for other views to simplify dependencies if we just want to test navigation
      4 | // But let's import real classes since it's an integration test

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (tests/integration/navigation.integration.test.js:1:1)

 FAIL  tests/integration/configForm.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/courses/components/AddManualModal.js'

    Require stack:
      features/courses/components/AddManualModal.js
      features/settings/ui/SettingsView.js
      tests/integration/configForm.integration.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { CourseRepository } from '../data/CourseRepository.js';
      3 |
      4 | export class AddManualModal extends Modal {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/courses/components/AddManualModal.js:1:1)
      at Object.require (features/settings/ui/SettingsView.js:1:1)
      at Object.require (tests/integration/configForm.integration.test.js:1:1)

 FAIL  tests/integration/addCourse.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/courses/components/AddManualModal.js'

    Require stack:
      features/courses/components/AddManualModal.js
      features/settings/ui/SettingsView.js
      tests/integration/addCourse.integration.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { CourseRepository } from '../data/CourseRepository.js';
      3 |
      4 | export class AddManualModal extends Modal {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/courses/components/AddManualModal.js:1:1)
      at Object.require (features/settings/ui/SettingsView.js:1:1)
      at Object.require (tests/integration/addCourse.integration.test.js:1:1)

 FAIL  tests/components/ActionMenu.test.js
  â— Test suite failed to run

    Cannot find module '../../sidepanel/components/Shared/ActionMenu.js' from 'tests/components/ActionMenu.test.js'

    > 1 | import { ActionMenu } from '../../sidepanel/components/Shared/ActionMenu.js';
        | ^
      2 |
      3 | describe('ActionMenu Component', () => {
      4 |   let actionMenu;

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (tests/components/ActionMenu.test.js:1:1)

Summary of all failing tests
 FAIL  tests/imports.test.js (5.625 s)
  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/settings/ui/SettingsView.js

    LINK QUEBRADO: 'features/settings/ui/SettingsView.js' tenta importar '../../../sidepanel/utils/statusManager.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/utils/statusManager.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/import/components/BatchImportModal.js

    LINK QUEBRADO: 'features/import/components/BatchImportModal.js' tenta importar '../../../sidepanel/components/Modals/Modal.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/components/Modals/Modal.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/CoursesList.js

    LINK QUEBRADO: 'features/courses/components/CoursesList.js' tenta importar '../../../sidepanel/components/Shared/ActionMenu.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/components/Shared/ActionMenu.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Arquivo deve ter imports vÃ¡lidos: /home/sant/extensaoUNIVESP/features/courses/components/AddManualModal.js

    LINK QUEBRADO: 'features/courses/components/AddManualModal.js' tenta importar '../../../sidepanel/components/Modals/Modal.js', mas o arquivo nÃ£o existe em '/home/sant/extensaoUNIVESP/sidepanel/components/Modals/Modal.js'.

      53 |
      54 |       if (!exists) {
    > 55 |         throw new Error(
         |               ^
      56 |           `LINK QUEBRADO: '${relativeFilePath}' tenta importar '${importPath}', mas o arquivo nÃ£o existe em '${resolvedPath}'.`
      57 |         );
      58 |       }

      at tests/imports.test.js:55:15

  â— VerificaÃ§Ã£o de Integridade de Links (Anti-Tela Branca) â€º Manifest resources devem existir

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      73 |     if (manifest.side_panel && manifest.side_panel.default_path) {
      74 |       const spPath = path.join(projectRoot, manifest.side_panel.default_path);
    > 75 |       expect(fs.existsSync(spPath)).toBe(true);
         |                                     ^
      76 |     }
      77 |
      78 |     // Verifica content scripts

      at Object.toBe (tests/imports.test.js:75:37)

 FAIL  features/import/tests/BatchImportModal.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/import/components/BatchImportModal.js'

    Require stack:
      features/import/components/BatchImportModal.js
      features/import/tests/BatchImportModal.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { scrapeAvailableTerms, processSelectedCourses } from '../services/BatchScraper.js';
      3 | import { CourseRepository } from '../../courses/data/CourseRepository.js';
      4 | import { parseTerm } from '../../courses/logic/TermParser.js';

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/import/components/BatchImportModal.js:1:1)
      at Object.require (features/import/tests/BatchImportModal.test.js:1:1)

 FAIL  tests/integration/scrapeCourse.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/courses/components/AddManualModal.js'

    Require stack:
      features/courses/components/AddManualModal.js
      features/settings/ui/SettingsView.js
      tests/integration/scrapeCourse.integration.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { CourseRepository } from '../data/CourseRepository.js';
      3 |
      4 | export class AddManualModal extends Modal {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/courses/components/AddManualModal.js:1:1)
      at Object.require (features/settings/ui/SettingsView.js:1:1)
      at Object.require (tests/integration/scrapeCourse.integration.test.js:1:1)

 FAIL  tests/integration/navigation.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../sidepanel/components/Layout/MainLayout.js' from 'tests/integration/navigation.integration.test.js'

    > 1 | import { MainLayout } from '../../sidepanel/components/Layout/MainLayout.js';
        | ^
      2 | import { HomeView } from '../../features/home/ui/HomeView.js';
      3 | // We can use mocks for other views to simplify dependencies if we just want to test navigation
      4 | // But let's import real classes since it's an integration test

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (tests/integration/navigation.integration.test.js:1:1)

 FAIL  tests/integration/configForm.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/courses/components/AddManualModal.js'

    Require stack:
      features/courses/components/AddManualModal.js
      features/settings/ui/SettingsView.js
      tests/integration/configForm.integration.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { CourseRepository } from '../data/CourseRepository.js';
      3 |
      4 | export class AddManualModal extends Modal {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/courses/components/AddManualModal.js:1:1)
      at Object.require (features/settings/ui/SettingsView.js:1:1)
      at Object.require (tests/integration/configForm.integration.test.js:1:1)

 FAIL  tests/integration/addCourse.integration.test.js
  â— Test suite failed to run

    Cannot find module '../../../sidepanel/components/Modals/Modal.js' from 'features/courses/components/AddManualModal.js'

    Require stack:
      features/courses/components/AddManualModal.js
      features/settings/ui/SettingsView.js
      tests/integration/addCourse.integration.test.js

    > 1 | import { Modal } from '../../../sidepanel/components/Modals/Modal.js';
        | ^
      2 | import { CourseRepository } from '../data/CourseRepository.js';
      3 |
      4 | export class AddManualModal extends Modal {

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (features/courses/components/AddManualModal.js:1:1)
      at Object.require (features/settings/ui/SettingsView.js:1:1)
      at Object.require (tests/integration/addCourse.integration.test.js:1:1)

 FAIL  tests/components/ActionMenu.test.js
  â— Test suite failed to run

    Cannot find module '../../sidepanel/components/Shared/ActionMenu.js' from 'tests/components/ActionMenu.test.js'

    > 1 | import { ActionMenu } from '../../sidepanel/components/Shared/ActionMenu.js';
        | ^
      2 |
      3 | describe('ActionMenu Component', () => {
      4 |   let actionMenu;

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.require (tests/components/ActionMenu.test.js:1:1)


Test Suites: 7 failed, 14 passed, 21 total
Tests:       5 failed, 144 passed, 149 total
Snapshots:   0 total
Time:        18.413 s
Ran all test suites.
sant@penguin:~/extensaoUNIVESP (refactor/sidepanel_old)$ 
sant@penguin:~/extensaoUNIVESP (refactor/sidepanel_old)$ 